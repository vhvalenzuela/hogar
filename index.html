<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chronos Nexus | Instalación Artística Digital</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Jost:wght@200;300;400;500&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --color-bg: #080808;
      --color-primary: #f2f2f2;
      --color-accent: #00e5ff;
      --color-accent-alt: #ff00aa;
      --color-dark: #121212;
      --color-text: #ffffff;
      --font-display: 'Syncopate', sans-serif;
      --font-body: 'Jost', sans-serif;
      --transition-slow: 1.5s cubic-bezier(0.23, 1, 0.32, 1);
      --transition-medium: 0.8s cubic-bezier(0.23, 1, 0.32, 1);
      --transition-fast: 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    }

    body {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background-color: var(--color-bg);
      color: var(--color-text);
      font-family: var(--font-body);
      font-weight: 300;
      position: relative;
      perspective: 1000px;
    }

    /* Canvas layers */
    .canvas-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    /* Main container */
    .nexus-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 2;
      display: flex;
      justify-content: center;
      align-items: center;
      perspective: 1200px;
    }

    /* Module system */
    .module {
      position: absolute;
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--transition-slow), transform var(--transition-slow), visibility 0s linear var(--transition-slow);
      transform: translateY(20px) scale(0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform-style: preserve-3d;
      width: 100%;
      height: 100%;
    }

    .module.active {
      opacity: 1;
      visibility: visible;
      transform: translateY(0) scale(1);
      transition: opacity var(--transition-slow), transform var(--transition-slow), visibility 0s linear 0s;
    }

    /* Time Module */
    .time-module {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
    }

    .time-container {
      position: relative;
      width: 80vmin;
      height: 80vmin;
      display: flex;
      justify-content: center;
      align-items: center;
      transform-style: preserve-3d;
    }

    .time-display {
      font-family: var(--font-display);
      font-size: 10vmin;
      font-weight: 400;
      letter-spacing: 0.2em;
      color: var(--color-primary);
      text-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
      margin-bottom: 2vmin;
      position: relative;
      z-index: 3;
    }

    .date-display {
      font-size: 2vmin;
      opacity: 0.7;
      font-weight: 300;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      position: relative;
      z-index: 3;
    }

    .time-ring {
      position: absolute;
      border-radius: 50%;
      border: 1px solid rgba(0, 229, 255, 0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      transform-style: preserve-3d;
      transition: all var(--transition-medium);
    }

    .time-grid {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      overflow: hidden;
      opacity: 0.2;
    }

    .grid-line {
      position: absolute;
      background-color: var(--color-accent);
      transform-origin: center;
    }

    .horizontal-line {
      width: 100%;
      height: 1px;
    }

    .vertical-line {
      width: 1px;
      height: 100%;
    }

    /* Weather Module */
    .weather-module {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
    }

    .weather-container {
      position: relative;
      width: 80vmin;
      height: 80vmin;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .weather-display {
      position: relative;
      width: 60vmin;
      height: 60vmin;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }

    .temp-display {
      font-family: var(--font-display);
      font-size: 12vmin;
      font-weight: 400;
      margin-bottom: 2vmin;
      color: var(--color-accent);
      text-shadow: 0 0 20px rgba(0, 229, 255, 0.3);
    }

    .weather-condition {
      font-size: 3vmin;
      opacity: 0.9;
      margin-bottom: 2vmin;
      font-weight: 300;
      text-transform: uppercase;
      letter-spacing: 0.2em;
    }

    .location-display {
      font-size: 2vmin;
      opacity: 0.6;
      font-weight: 300;
      letter-spacing: 0.1em;
    }

    .weather-particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    /* Quote Module */
    .quote-module {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      padding: 5vmin;
    }

    .quote-container {
      position: relative;
      max-width: 80vmin;
      background: rgba(18, 18, 18, 0.5);
      border: 1px solid rgba(0, 229, 255, 0.2);
      padding: 8vmin;
      transform-style: preserve-3d;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(5px);
    }

    .quote-text {
      font-family: var(--font-body);
      font-size: 4vmin;
      font-weight: 200;
      line-height: 1.4;
      margin-bottom: 4vmin;
      position: relative;
      z-index: 2;
    }

    .quote-author {
      font-size: 2.5vmin;
      opacity: 0.7;
      font-weight: 300;
      text-align: right;
      position: relative;
      z-index: 2;
      font-family: var(--font-display);
      letter-spacing: 0.1em;
    }

    .quote-decoration {
      position: absolute;
      font-family: var(--font-display);
      font-size: 20vmin;
      color: var(--color-accent);
      opacity: 0.1;
      top: -4vmin;
      left: 2vmin;
      transform: translateZ(10px);
      z-index: 1;
    }

    /* Photo Module - Completely Redesigned */
    .photo-module {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      overflow: hidden;
      perspective: 1200px;
    }

    .photo-container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .photo-showcase {
      position: relative;
      width: 80vmin;
      height: 80vmin;
      transform-style: preserve-3d;
    }

    .photo-frame {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transform: translateZ(-500px) rotateY(0deg);
      transition: opacity 1s ease, transform 1.5s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .photo-frame.active {
      opacity: 1;
      transform: translateZ(0) rotateY(0deg);
      z-index: 10;
    }

    .photo-frame.prev {
      opacity: 0;
      transform: translateZ(-500px) rotateY(-60deg);
      z-index: 1;
    }

    .photo-frame.next {
      opacity: 0;
      transform: translateZ(-500px) rotateY(60deg);
      z-index: 1;
    }

.photo-image-container {
  position: relative;
  max-width: 118vmin;
  max-height: 85vmin;
  width: auto;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(0, 229, 255, 0.3);
  background: rgba(0, 0, 0, 0.3);
  transform-style: preserve-3d;
}

.photo-image {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  transition: transform 10s ease;
  transform: scale(1);
}

    .photo-frame.active .photo-image {
      transform: scale(1.05);
    }

    .photo-info {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      padding: 3vmin;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
      transform: translateY(0);
    }

    .photo-title {
      font-family: var(--font-display);
      font-size: 2.5vmin;
      margin-bottom: 1vmin;
      color: var(--color-accent);
      letter-spacing: 0.2em;
    }

    .photo-description {
      font-size: 1.8vmin;
      opacity: 0.8;
      max-width: 80%;
    }

    .photo-counter {
      position: absolute;
      bottom: 10%;
      left: 0;
      width: 100%;
      text-align: center;
      font-family: var(--font-display);
      font-size: 1.5vmin;
      color: rgba(255, 255, 255, 0.5);
      letter-spacing: 0.5em;
    }

    .photo-progress {
      position: absolute;
      bottom: 8%;
      left: 50%;
      transform: translateX(-50%);
      width: 20vmin;
      height: 2px;
      background: rgba(255, 255, 255, 0.2);
    }

    .photo-progress-bar {
      height: 100%;
      width: 0;
      background: var(--color-accent);
      transition: width 0.5s linear;
    }

    /* Music Module */
    .music-module {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
    }

    .music-container {
      position: relative;
      width: 80vmin;
      height: 60vmin;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .album-art {
      position: relative;
      width: 40vmin;
      height: 40vmin;
      overflow: hidden;
      box-shadow: 0 0 50px rgba(0, 229, 255, 0.2);
      z-index: 2;
      transform-style: preserve-3d;
      transform: translateZ(50px);
      transition: transform var(--transition-medium), box-shadow var(--transition-medium);
      border: 1px solid rgba(0, 229, 255, 0.2);
    }

    .album-art img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 10s ease;
    }

    .music-info {
      position: relative;
      margin-top: 4vmin;
      text-align: center;
      z-index: 2;
      transform-style: preserve-3d;
      transform: translateZ(30px);
    }

    .song-title {
      font-family: var(--font-display);
      font-size: 3vmin;
      font-weight: 400;
      margin-bottom: 1vmin;
      color: var(--color-accent);
      text-shadow: 0 0 20px rgba(0, 229, 255, 0.3);
      letter-spacing: 0.1em;
    }

    .artist-name {
      font-size: 2.5vmin;
      opacity: 0.9;
      margin-bottom: 1vmin;
      font-weight: 300;
    }

    .album-name {
      font-size: 2vmin;
      opacity: 0.7;
      font-weight: 300;
    }

    .music-visualizer {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 10vmin;
      display: flex;
      justify-content: center;
      align-items: flex-end;
      z-index: 1;
    }

    .visualizer-bar {
      width: 0.5vmin;
      height: 2vmin;
      background-color: var(--color-accent);
      margin: 0 0.25vmin;
      border-radius: 1px;
      transition: height var(--transition-fast);
    }

    /* Data Visualization Module - Completely Redesigned */
/* Quantum Canvas Module - Artistic Digital Installation */
.data-module {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  overflow: hidden;
  perspective: 2000px;
}

.data-container {
  position: relative;
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.quantum-canvas {
  position: relative;
  width: 90vmin;
  height: 90vmin;
  transform-style: preserve-3d;
}

.quantum-field {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(0, 229, 255, 0.1) 0%, transparent 70%);
  animation: quantum-pulse 8s infinite ease-in-out;
}

.quantum-particle {
  position: absolute;
  width: 3px;
  height: 3px;
  background: var(--color-accent);
  border-radius: 50%;
  box-shadow: 0 0 10px var(--color-accent);
}

.quantum-wave {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 2px;
  height: 60vmin;
  background: linear-gradient(to bottom, 
    transparent 0%, 
    rgba(0, 229, 255, 0.8) 20%, 
    rgba(255, 0, 170, 0.8) 50%, 
    rgba(0, 229, 255, 0.8) 80%, 
    transparent 100%);
  transform-origin: center bottom;
  transform: translate(-50%, -50%);
  filter: blur(1px);
}

.quantum-spiral {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 1px;
  height: 40vmin;
  background: linear-gradient(to top, transparent, var(--color-accent-alt));
  transform-origin: center bottom;
  transform: translate(-50%, 0);
}

.quantum-title {
  position: absolute;
  top: 15%;
  left: 0;
  width: 100%;
  text-align: center;
  font-family: var(--font-display);
  font-size: 2.5vmin;
  color: var(--color-accent);
  letter-spacing: 0.5em;
  text-transform: uppercase;
  opacity: 0.8;
}

@keyframes quantum-pulse {
  0%, 100% {
    transform: scale(1) rotate(0deg);
    opacity: 0.3;
  }
  25% {
    transform: scale(1.1) rotate(90deg);
    opacity: 0.6;
  }
  50% {
    transform: scale(0.9) rotate(180deg);
    opacity: 0.4;
  }
  75% {
    transform: scale(1.05) rotate(270deg);
    opacity: 0.7;
  }
}

@keyframes particle-float {
  0% {
    transform: translateY(0) scale(1);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateY(-100vh) scale(0.5);
    opacity: 0;
  }
}

@keyframes wave-flow {
  0% {
    transform: translate(-50%, -50%) scaleY(0.5) rotate(0deg);
  }
  50% {
    transform: translate(-50%, -50%) scaleY(1.2) rotate(180deg);
  }
  100% {
    transform: translate(-50%, -50%) scaleY(0.8) rotate(360deg);
  }
}

    .nexus-digital {
      position: relative;
      width: 80vmin;
      height: 80vmin;
      transform-style: preserve-3d;
      transform: rotateX(20deg) rotateY(0deg);
      animation: rotate-slow 60s infinite linear;
    }

    .nexus-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 1px solid rgba(0, 229, 255, 0.2);
      transform-style: preserve-3d;
    }

    .nexus-core {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 15vmin;
      height: 15vmin;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(0, 229, 255, 0.3) 0%, rgba(0, 229, 255, 0) 70%);
      transform: translate(-50%, -50%);
      box-shadow: 0 0 30px rgba(0, 229, 255, 0.5);
      animation: pulse 4s infinite ease-in-out;
    }

    .nexus-beam {
      position: absolute;
      top: 50%;
      left: 50%;
      height: 1px;
      background: linear-gradient(90deg, rgba(0, 229, 255, 0) 0%, rgba(0, 229, 255, 0.8) 50%, rgba(0, 229, 255, 0) 100%);
      transform-origin: left center;
      transform: rotate(0deg);
    }

    .nexus-node {
      position: absolute;
      width: 2vmin;
      height: 2vmin;
      border-radius: 50%;
      background-color: var(--color-accent);
      transform: translate(-50%, -50%);
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.7);
    }

    .nexus-pulse {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 1px solid var(--color-accent);
      transform: translate(-50%, -50%) scale(0);
      opacity: 1;
      animation: nexus-pulse 3s infinite ease-out;
    }

    .nexus-info {
      position: absolute;
      padding: 1vmin 2vmin;
      background: rgba(0, 0, 0, 0.7);
      border: 1px solid rgba(0, 229, 255, 0.3);
      color: var(--color-accent);
      font-family: var(--font-display);
      font-size: 1.5vmin;
      letter-spacing: 0.1em;
      white-space: nowrap;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.5s ease;
      pointer-events: none;
    }

    .nexus-info.active {
      opacity: 1;
      transform: translateY(0);
    }

    .nexus-title {
      position: absolute;
      top: 10%;
      left: 0;
      width: 100%;
      text-align: center;
      font-family: var(--font-display);
      font-size: 3vmin;
      color: var(--color-accent);
      letter-spacing: 0.3em;
      text-transform: uppercase;
    }

    @keyframes rotate-slow {
      0% {
        transform: rotateX(20deg) rotateY(0deg);
      }
      100% {
        transform: rotateX(20deg) rotateY(360deg);
      }
    }

    @keyframes nexus-pulse {
      0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0;
      }
    }

    /* Loading indicator */
    .loading {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      background: var(--color-bg);
      transition: opacity 1s ease;
    }

    .loading.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loading-spinner {
      position: relative;
      width: 15vmin;
      height: 15vmin;
      margin-bottom: 5vmin;
    }

    .spinner-ring {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 2px solid transparent;
      border-top-color: var(--color-accent);
      border-bottom-color: var(--color-accent-alt);
      animation: spin 1.5s linear infinite;
    }

    .spinner-ring:nth-child(2) {
      width: 80%;
      height: 80%;
      top: 10%;
      left: 10%;
      border-top-color: var(--color-accent-alt);
      border-bottom-color: var(--color-accent);
      animation-duration: 2s;
      animation-direction: reverse;
    }

    .spinner-ring:nth-child(3) {
      width: 60%;
      height: 60%;
      top: 20%;
      left: 20%;
      animation-duration: 1s;
    }

    .loading-text {
      font-family: var(--font-display);
      font-size: 3vmin;
      color: var(--color-accent);
      font-weight: 400;
      letter-spacing: 0.5em;
      text-transform: uppercase;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive adjustments */
    @media (max-aspect-ratio: 1/1) {
      .photo-grid {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(6, 1fr);
      }
    }

    /* Glitch effect */
    .glitch {
      position: relative;
      animation: glitch-skew 1s infinite linear alternate-reverse;
    }

    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.8;
    }

    .glitch::before {
      color: var(--color-accent);
      animation: glitch-anim 5s infinite linear alternate-reverse;
    }

    .glitch::after {
      color: var(--color-accent-alt);
      animation: glitch-anim2 1s infinite linear alternate-reverse;
    }

    @keyframes glitch-anim {
      0% {
        clip-path: inset(80% 0 0 0);
        transform: translate(-0.2em, -0.04em);
      }
      10% {
        clip-path: inset(10% 0 85% 0);
        transform: translate(0.13em, -0.06em);
      }
      20% {
        clip-path: inset(80% 0 0 0);
        transform: translate(-0.09em, 0.04em);
      }
      30% {
        clip-path: inset(10% 0 85% 0);
        transform: translate(0.06em, 0.08em);
      }
      40% {
        clip-path: inset(50% 0 30% 0);
        transform: translate(0.07em, 0.03em);
      }
      50% {
        clip-path: inset(10% 0 85% 0);
        transform: translate(-0.09em, -0.08em);
      }
      60% {
        clip-path: inset(40% 0 43% 0);
        transform: translate(-0.18em, -0.02em);
      }
      70% {
        clip-path: inset(80% 0 5% 0);
        transform: translate(0.13em, 0.05em);
      }
      80% {
        clip-path: inset(10% 0 85% 0);
        transform: translate(-0.09em, -0.06em);
      }
      90% {
        clip-path: inset(90% 0 1% 0);
        transform: translate(0.13em, 0.07em);
      }
      100% {
        clip-path: inset(5% 0 80% 0);
        transform: translate(-0.13em, -0.04em);
      }
    }

    @keyframes glitch-anim2 {
      0% {
        clip-path: inset(20% 0 60% 0);
        transform: translate(-0.1em, 0.06em);
      }
      20% {
        clip-path: inset(60% 0 10% 0);
        transform: translate(0.1em, -0.06em);
      }
      40% {
        clip-path: inset(40% 0 40% 0);
        transform: translate(-0.1em, -0.02em);
      }
      60% {
        clip-path: inset(5% 0 70% 0);
        transform: translate(0.1em, 0.06em);
      }
      80% {
        clip-path: inset(80% 0 10% 0);
        transform: translate(-0.1em, -0.06em);
      }
      100% {
        clip-path: inset(10% 0 60% 0);
        transform: translate(0.1em, 0.06em);
      }
    }

    @keyframes glitch-skew {
      0% {
        transform: skew(0deg);
      }
      20% {
        transform: skew(0deg);
      }
      24% {
        transform: skew(3deg);
      }
      28% {
        transform: skew(0deg);
      }
      70% {
        transform: skew(0deg);
      }
      74% {
        transform: skew(-2deg);
      }
      78% {
        transform: skew(0deg);
      }
      100% {
        transform: skew(0deg);
      }
    }

    /* Noise effect */
    .noise {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9;
      opacity: 0.03;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    }

    /* Scan line effect */
    .scanlines {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 8;
      pointer-events: none;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.02) 50%);
      background-size: 100% 4px;
    }

    /* Vignette effect */
    .vignette {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 7;
      pointer-events: none;
      background: radial-gradient(circle, transparent 60%, rgba(0, 0, 0, 0.5) 100%);
    }
  </style>
</head>
<body>
  <div class="loading" id="loading">
    <div class="loading-spinner">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
    </div>
    <div class="loading-text glitch" data-text="CHRONOS NEXUS">CHRONOS NEXUS</div>
  </div>

  <audio id="background-music" loop></audio>

  <div class="canvas-container">
    <canvas id="background-canvas"></canvas>
    <canvas id="particles-canvas"></canvas>
  </div>

  <div class="nexus-container">
    <!-- Time Module -->
    <div class="module time-module" id="time-module">
      <div class="time-container">
        <div class="time-display glitch" id="time" data-text="00:00">00:00</div>
        <div class="date-display" id="date">Lunes, 1 de Enero</div>
        <div id="time-rings"></div>
        <div class="time-grid" id="time-grid"></div>
      </div>
    </div>

    <!-- Weather Module -->
    <div class="module weather-module" id="weather-module">
      <div class="weather-container">
        <div class="weather-display">
          <div class="temp-display glitch" id="temperature" data-text="--°C">--°C</div>
          <div class="weather-condition" id="weather-condition">Cargando...</div>
          <div class="location-display">Ciudad Obregón, Sonora</div>
        </div>
        <div class="weather-particles" id="weather-particles"></div>
      </div>
    </div>

    <!-- Quote Module -->
    <div class="module quote-module" id="quote-module">
      <div class="quote-container">
        <div class="quote-decoration">"</div>
        <div class="quote-text" id="quote-text"></div>
        <div class="quote-author" id="quote-author"></div>
      </div>
    </div>

    <!-- Photo Module - Completely Redesigned -->
    <div class="module photo-module" id="photo-module">
      <div class="photo-container">
        <div class="photo-showcase" id="photo-showcase">
          <!-- Photo frames will be added dynamically -->
        </div>
        <div class="photo-counter" id="photo-counter">01 / 09</div>
        <div class="photo-progress">
          <div class="photo-progress-bar" id="photo-progress-bar"></div>
        </div>
      </div>
    </div>

    <!-- Music Module -->
    <div class="module music-module" id="music-module">
      <div class="music-container">
        <div class="album-art">
          <img id="album-cover-img" src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?q=80&w=2070&auto=format&fit=crop" alt="Portada del álbum">
        </div>
        <div class="music-info">
          <div class="song-title glitch" id="song-title" data-text="CARGANDO...">CARGANDO...</div>
          <div class="artist-name" id="artist-name">Artista</div>
          <div class="album-name" id="album-name">Álbum</div>
        </div>
        <div class="music-visualizer" id="music-visualizer">
          <!-- Visualizer bars will be added here dynamically -->
        </div>
      </div>
    </div>

    <!-- Data Visualization Module - Completely Redesigned -->
    <div class="module data-module" id="data-module">
      <div class="data-container">
        <div class="nexus-title">NEXUS DIGITAL</div>
        <div class="nexus-digital" id="nexus-digital">
          <div class="nexus-core"></div>
          <!-- Layers, beams and nodes will be added dynamically -->
        </div>
      </div>
    </div>
  </div>

  <!-- Visual effects layers -->
  <div class="noise"></div>
  <div class="scanlines"></div>
  <div class="vignette"></div>

  <script>
    // ===== CONFIGURATION =====
    const CONFIG = {
      modules: [
        'time-module',
        'weather-module', 
        'quote-module', 
        'photo-module', 
        'music-module',
        'data-module'
      ],
      moduleDuration: 30000, // 30 seconds per module
      
      // Background configuration
      background: {
        color1: '#080808',
        color2: '#121212',
        noiseIntensity: 0.05,
        speed: 0.002
      },
      
      // Particle system configuration
      particles: {
        count: 150,
        minSize: 1,
        maxSize: 3,
        speed: 0.3,
        connectionDistance: 150,
        color: '#00e5ff'
      },
      
      // Music playlist
      playlist: [
        {
          title: "Dj Set Gaga",
          artist: "Manu Oropeza DJ",
          album: "MAYHEM, ARTPOP, The Fame, Born This Way, Chromatica",
          cover: "https://i.ytimg.com/vi/V-4xoVSfQl0/mqdefault.jpg",
          file: "https://pixeldrain.com/api/file/tD8zQxSG"
        },
        {
          title: "All time Ibiza Anthems",
          artist: "DJ Calvin Bën",
          album: "House & Dance Classics on Vinyl",
          cover: "https://i.ytimg.com/vi/ijfv1ywTe94/hq720.jpg",
          file: "https://pixeldrain.com/api/file/u22jpopF"
        },
        {
          title: "Oldschool House Classics Dj Set",
          artist: "DJ Calvin Bën",
          album: "100% Vinyl Set",
          cover: "https://i1.sndcdn.com/avatars-000370682921-kawcd1-t240x240.jpg",
          file: "https://pixeldrain.com/api/file/x1FAzRHM"
        },
        {
          title: "Funky & Groovy Deep Jazz House DJ Mix",
          artist: "RE:TAPE Studios",
          album: "Summer Sunset Vibes",
          cover: "https://i.ytimg.com/vi/qDAgkOuijUg/maxresdefault.jpg",
          file: "https://pixeldrain.com/api/file/r6dCUGvZ"
        }
      ],
      
      // Photo gallery - Enhanced with more metadata
      photos: [
        {
          url: "img/f01.jpg",
          title: "Cumple Vic",
          description: "Reunión con amistades en Bella Loreto",
          featured: true,
          category: "space"
        },
        {
          url: "img/f02.jpg",
          title: "Cumple Alan",
          description: "La Yaha, la Anie, el Alan y el Vic, en la casa.",
          featured: false,
          category: "nature"
        },
        {
          url: "img/f03.jpg",
          title: "En la XV de la Carito",
          description: "Presentación en sociedad del Alan xD",
          featured: false,
          category: "space"
        },
        {
          url: "img/f04.jpg",
          title: "Fiesta en Provi",
          description: "Una fiesta en el pueblo",
          featured: false,
          category: "abstract"
        },
        {
          url: "img/f05.jpg",
          title: "Boda Denisse y Alex",
          description: "En la boda, en el 2024",
          featured: true,
          category: "space"
        },
        {
          url: "img/f06.jpg",
          title: "Dando el rol por Oaxaca",
          description: "Listos para iniciar el recorrido por los pueblos cercanos! :P",
          featured: false,
          category: "nature"
        },
        {
          url: "img/f07.jpg",
          title: "Agapanthus africanus",
          description: "Este agapando me lo compró el Alan en Oaxaca! <3",
          featured: false,
          category: "space"
        },
        {
          url: "img/f08.jpg",
          title: "Ángel de la Independencia",
          description: "Un día muy especial, a los pies del Ángel",
          featured: false,
          category: "abstract"
        },
        {
          url: "img/f09.jpg",
          title: "The Water Boils",
          description: "Explorando Hierve el Agua en Oaxaca",
          featured: true,
          category: "space"
        },
                {
          url: "img/f10.jpg",
          title: "San Carlos",
          description: "Amaneciendo en la playa...",
          featured: true,
          category: "space"
        },
                {
          url: "img/f11.jpg",
          title: "En Álamos",
          description: "Visitando Álamos, Sonora",
          featured: true,
          category: "space"
        },
                {
          url: "img/f12.jpg",
          title: "Visitantes de CDMX conociendo San Carlos",
          description: "Ese día tuvimos la visita de Angy y Estelita, de la CDMX. Nos fuimos a San Carlos",
          featured: true,
          category: "space"
        },
                {
          url: "img/f13.jpg",
          title: "14/04/2022",
          description: "Un lugar lindo y una fecha para recordar! <3",
          featured: true,
          category: "space"
        },
                {
          url: "img/f14.jpg",
          title: "Yateando",
          description: "En San Carlos",
          featured: true,
          category: "space"
        },
                {
          url: "img/f15.jpg",
          title: "Con las plebes!",
          description: "Con la Anie y la Merit! =)",
          featured: true,
          category: "space"
        },
                        {
          url: "img/f16.jpg",
          title: "Otra de los XV de la Carito! xD",
          description: "La pasamos re-bien.com! hahaha",
          featured: true,
          category: "space"
        }
      ],
      
      // Quotes collection
      quotes: [
        { 
          quote: "El tiempo es una ilusión, y el futuro no existe hasta que lo creamos.", 
          author: "CHRONOS PROJECT" 
        },
        { 
          quote: "La realidad es simplemente una serie de ecuaciones esperando ser resueltas.", 
          author: "QUANTUM DIVISION" 
        },
        { 
          quote: "En el espacio entre los átomos existe todo lo que somos y todo lo que seremos.", 
          author: "PARTICLE THEORY" 
        },
        { 
          quote: "La tecnología avanzada es indistinguible de la magia para aquellos que no la comprenden.", 
          author: "NEXUS PROTOCOL" 
        },
        { 
          quote: "Somos polvo de estrellas contemplando el universo que nos creó.", 
          author: "COSMIC AWARENESS" 
        },
        { 
          quote: "El arte digital es la fusión perfecta entre la lógica matemática y la expresión humana.", 
          author: "CREATIVE ALGORITHM" 
        },
        { 
          quote: "La simplicidad es la máxima sofisticación en un universo de complejidad infinita.", 
          author: "DESIGN MATRIX" 
        },
        { 
          quote: "La creatividad es la inteligencia divirtiéndose en los límites de lo posible.", 
          author: "NEURAL NETWORK" 
        },
        { 
          quote: "El silencio digital es el lienzo en blanco de la era de la información.", 
          author: "DATA VOID" 
        },
        { 
          quote: "La música es matemática emocional resonando en el espacio-tiempo.", 
          author: "HARMONIC SEQUENCE" 
        }
      ],
      
      // Data visualization
      dataPoints: 150
    };

    // ===== STATE MANAGEMENT =====
    let state = {
      currentModule: 0,
      weatherData: null,
      particles: [],
      photoItems: [],
      currentTrackIndex: 0,
      audioContext: null,
      audioAnalyser: null,
      audioSource: null,
      audioData: null,
      visualizerBars: [],
      dataPoints: [],
      dataConnections: [],
      timeRings: [],
      noiseOffset: 0,
      photoFrames: [],
      currentPhotoIndex: 0,
      nexusLayers: [],
      nexusNodes: [],
      nexusBeams: []
    };

    // ===== CANVAS SETUP =====
    const backgroundCanvas = document.getElementById('background-canvas');
    const backgroundCtx = backgroundCanvas.getContext('2d');
    const particlesCanvas = document.getElementById('particles-canvas');
    const particlesCtx = particlesCanvas.getContext('2d');

    function resizeCanvas() {
      backgroundCanvas.width = window.innerWidth;
      backgroundCanvas.height = window.innerHeight;
      particlesCanvas.width = window.innerWidth;
      particlesCanvas.height = window.innerHeight;
      
      // Reinitialize particles when canvas is resized
      initParticles();
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // ===== BACKGROUND EFFECT =====
    function updateBackground() {
      const width = backgroundCanvas.width;
      const height = backgroundCanvas.height;
      
      // Create gradient background
      const gradient = backgroundCtx.createLinearGradient(0, 0, width, height);
      gradient.addColorStop(0, CONFIG.background.color1);
      gradient.addColorStop(1, CONFIG.background.color2);
      
      backgroundCtx.fillStyle = gradient;
      backgroundCtx.fillRect(0, 0, width, height);
      
      // Add subtle animated noise
      state.noiseOffset += CONFIG.background.speed;
      
      // We'll simulate noise with a simple pattern for performance
      for (let i = 0; i < 100; i++) {
        const x = Math.random() * width;
        const y = Math.random() * height;
        const size = Math.random() * 2;
        const opacity = Math.random() * CONFIG.background.noiseIntensity;
        
        backgroundCtx.fillStyle = `rgba(255, 255, 255, ${opacity})`;
        backgroundCtx.beginPath();
        backgroundCtx.arc(x, y, size, 0, Math.PI * 2);
        backgroundCtx.fill();
      }
    }

    // ===== PARTICLES SYSTEM =====
    function initParticles() {
      state.particles = [];
      
      for (let i = 0; i < CONFIG.particles.count; i++) {
        state.particles.push({
          x: Math.random() * particlesCanvas.width,
          y: Math.random() * particlesCanvas.height,
          size: CONFIG.particles.minSize + Math.random() * (CONFIG.particles.maxSize - CONFIG.particles.minSize),
          speedX: (Math.random() - 0.5) * CONFIG.particles.speed,
          speedY: (Math.random() - 0.5) * CONFIG.particles.speed,
          opacity: 0.3 + Math.random() * 0.5
        });
      }
    }

    function updateParticles() {
      particlesCtx.clearRect(0, 0, particlesCanvas.width, particlesCanvas.height);
      
      // Draw connections between particles
      particlesCtx.lineWidth = 1;
      
      for (let i = 0; i < state.particles.length; i++) {
        for (let j = i + 1; j < state.particles.length; j++) {
          const dx = state.particles[i].x - state.particles[j].x;
          const dy = state.particles[i].y - state.particles[j].y;
          const distance = Math.sqrt(dx * dx + dy * dy);
          
          if (distance < CONFIG.particles.connectionDistance) {
            const opacity = (1 - distance / CONFIG.particles.connectionDistance) * 0.3;
            particlesCtx.strokeStyle = `rgba(0, 229, 255, ${opacity})`;
            particlesCtx.beginPath();
            particlesCtx.moveTo(state.particles[i].x, state.particles[i].y);
            particlesCtx.lineTo(state.particles[j].x, state.particles[j].y);
            particlesCtx.stroke();
          }
        }
      }
      
      // Update and draw particles
      state.particles.forEach(particle => {
        // Update position
        particle.x += particle.speedX;
        particle.y += particle.speedY;
        
        // Bounce off edges
        if (particle.x < 0 || particle.x > particlesCanvas.width) {
          particle.speedX *= -1;
        }
        if (particle.y < 0 || particle.y > particlesCanvas.height) {
          particle.speedY *= -1;
        }
        
        // Draw particle
        particlesCtx.fillStyle = `rgba(0, 229, 255, ${particle.opacity})`;
        particlesCtx.beginPath();
        particlesCtx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
        particlesCtx.fill();
      });
    }

    // ===== TIME MODULE =====
    function initTimeModule() {
      // Create time rings
      const ringsContainer = document.getElementById('time-rings');
      ringsContainer.innerHTML = '';
      state.timeRings = [];
      
      const ringCount = 5;
      for (let i = 0; i < ringCount; i++) {
        const ring = document.createElement('div');
        ring.className = 'time-ring';
        
        const size = 80 - i * 15;
        ring.style.width = `${size}vmin`;
        ring.style.height = `${size}vmin`;
        
        // Add rotation animation
        const direction = i % 2 === 0 ? 'normal' : 'reverse';
        const duration = 30 + i * 15;
        ring.style.animation = `spin ${duration}s linear infinite ${direction}`;
        
        ringsContainer.appendChild(ring);
        state.timeRings.push(ring);
      }
      
      // Create time grid
      const gridContainer = document.getElementById('time-grid');
      gridContainer.innerHTML = '';
      
      // Add horizontal lines
      for (let i = 0; i < 9; i++) {
        const line = document.createElement('div');
        line.className = 'grid-line horizontal-line';
        line.style.top = `${i * 12.5}%`;
        gridContainer.appendChild(line);
      }
      
      // Add vertical lines
      for (let i = 0; i < 9; i++) {
        const line = document.createElement('div');
        line.className = 'grid-line vertical-line';
        line.style.left = `${i * 12.5}%`;
        gridContainer.appendChild(line);
      }
    }

    function updateTime() {
      const now = new Date();
      
      // Format time (24-hour for futuristic look)
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      
      // Update time display
      const timeElement = document.getElementById('time');
      timeElement.textContent = `${hours}:${minutes}`;
      timeElement.setAttribute('data-text', `${hours}:${minutes}`);
      
      // Format date
      const options = { weekday: 'long', day: 'numeric', month: 'long' };
      const dateString = now.toLocaleDateString('es-MX', options);
      document.getElementById('date').textContent = dateString.toUpperCase();
      
      // Update time rings if needed
      updateTimeRings(now);
    }

    function updateTimeRings(now) {
      if (!state.timeRings.length) return;
      
      const seconds = now.getSeconds();
      const minutes = now.getMinutes();
      const hours = now.getHours();
      
      // Update ring colors based on time
      state.timeRings.forEach((ring, index) => {
        let opacity;
        let color;
        
        switch(index) {
          case 0: // Seconds ring
            opacity = 0.1 + (seconds / 60) * 0.3;
            color = `rgba(0, 229, 255, ${opacity})`;
            break;
          case 1: // Minutes ring
            opacity = 0.1 + (minutes / 60) * 0.3;
            color = `rgba(255, 0, 170, ${opacity})`;
            break;
          case 2: // Hours ring
            opacity = 0.1 + (hours / 24) * 0.3;
            color = `rgba(0, 229, 255, ${opacity})`;
            break;
          default:
            opacity = 0.1;
            color = `rgba(255, 255, 255, ${opacity})`;
        }
        
        ring.style.borderColor = color;
      });
    }

    // ===== WEATHER MODULE =====
    async function fetchWeatherData() {
      // Use placeholder weather data
      usePlaceholderWeatherData();
    }

    function usePlaceholderWeatherData() {
      // Create placeholder data based on time of day and season
      const now = new Date();
      const month = now.getMonth(); // 0-11
      const hour = now.getHours(); // 0-23
      
      // Seasonal temperature adjustments for Ciudad Obregón
      let baseTemp;
      if (month >= 5 && month <= 8) { // Summer (Jun-Sep)
        baseTemp = 35 + Math.random() * 5;
      } else if (month >= 9 && month <= 10) { // Fall (Oct-Nov)
        baseTemp = 25 + Math.random() * 5;
      } else if (month >= 11 || month <= 1) { // Winter (Dec-Feb)
        baseTemp = 18 + Math.random() * 5;
      } else { // Spring (Mar-May)
        baseTemp = 28 + Math.random() * 5;
      }
      
      // Time of day adjustments
      let tempAdjustment = 0;
      let weatherDescription = 'CIELO DESPEJADO';
      let cloudCover = 10 + Math.random() * 20;
      
      if (hour >= 0 && hour < 6) { // Night
        tempAdjustment = -5;
        weatherDescription = 'NOCHE DESPEJADA';
        cloudCover = 5 + Math.random() * 10;
      } else if (hour >= 6 && hour < 12) { // Morning
        tempAdjustment = -2;
        weatherDescription = 'PARCIALMENTE NUBLADO';
        cloudCover = 30 + Math.random() * 20;
      } else if (hour >= 12 && hour < 18) { // Afternoon
        tempAdjustment = 2;
        if (Math.random() > 0.7) {
          weatherDescription = 'ALGO NUBLADO';
          cloudCover = 40 + Math.random() * 30;
        } else {
          weatherDescription = 'CIELO DESPEJADO';
          cloudCover = 10 + Math.random() * 20;
        }
      } else { // Evening
        tempAdjustment = -1;
        weatherDescription = 'NOCHE DESPEJADA';
        cloudCover = 20 + Math.random() * 20;
      }
      
      const finalTemp = baseTemp + tempAdjustment;
      
      // Create weather data object
      state.weatherData = {
        main: {
          temp: finalTemp,
          humidity: 30 + Math.random() * 40,
          pressure: 1008 + Math.random() * 10
        },
        weather: [
          { description: weatherDescription }
        ],
        wind: {
          speed: 1 + Math.random() * 4 // m/s
        },
        clouds: {
          all: cloudCover
        }
      };
      
      updateWeatherDisplay(state.weatherData);
    }

    function updateWeatherDisplay(data) {
      const tempElement = document.getElementById('temperature');
      const tempText = `${Math.round(data.main.temp)}°C`;
      tempElement.textContent = tempText;
      tempElement.setAttribute('data-text', tempText);
      
      document.getElementById('weather-condition').textContent = data.weather[0].description;
      
      // Update weather particles based on conditions
      updateWeatherParticles(data);
    }

    function updateWeatherParticles(data) {
      const container = document.getElementById('weather-particles');
      container.innerHTML = '';
      
      const weatherDesc = data.weather[0].description.toLowerCase();
      const now = new Date();
      const hours = now.getHours();
      const isNight = hours >= 20 || hours < 6;
      
      // Create particles based on weather condition
      if (isNight) {
        // Stars for night
        for (let i = 0; i < 50; i++) {
          const star = document.createElement('div');
          star.className = 'star';
          star.style.position = 'absolute';
          star.style.width = `${0.2 + Math.random() * 0.3}vmin`;
          star.style.height = `${0.2 + Math.random() * 0.3}vmin`;
          star.style.backgroundColor = '#ffffff';
          star.style.borderRadius = '50%';
          star.style.left = `${Math.random() * 100}%`;
          star.style.top = `${Math.random() * 100}%`;
          star.style.opacity = `${0.3 + Math.random() * 0.7}`;
          star.style.boxShadow = '0 0 5px rgba(255, 255, 255, 0.8)';
          star.style.animation = `pulse ${2 + Math.random() * 3}s infinite ease-in-out ${Math.random() * 2}s`;
          container.appendChild(star);
        }
      } else if (weatherDesc.includes('nublado') || weatherDesc.includes('parcial')) {
        // Cloud particles
        for (let i = 0; i < 10; i++) {
          const cloud = document.createElement('div');
          cloud.style.position = 'absolute';
          cloud.style.width = `${20 + Math.random() * 30}vmin`;
          cloud.style.height = `${10 + Math.random() * 15}vmin`;
          cloud.style.borderRadius = '50%';
          cloud.style.background = 'rgba(255, 255, 255, 0.1)';
          cloud.style.filter = 'blur(5vmin)';
          cloud.style.top = `${Math.random() * 80}%`;
          cloud.style.left = `${Math.random() * 80}%`;
          cloud.style.animation = `float ${10 + Math.random() * 10}s infinite ease-in-out ${Math.random() * 5}s`;
          container.appendChild(cloud);
        }
      } else {
        // Sun particles for clear sky
        const sun = document.createElement('div');
        sun.style.position = 'absolute';
        sun.style.width = '30vmin';
        sun.style.height = '30vmin';
        sun.style.borderRadius = '50%';
        sun.style.background = 'radial-gradient(circle, rgba(0, 229, 255, 0.2) 0%, rgba(0, 229, 255, 0) 70%)';
        sun.style.top = '30%';
        sun.style.left = '30%';
        sun.style.boxShadow = '0 0 50px rgba(0, 229, 255, 0.3)';
        sun.style.animation = 'pulse 5s infinite ease-in-out';
        container.appendChild(sun);
        
        // Add some light rays
        for (let i = 0; i < 8; i++) {
          const ray = document.createElement('div');
          ray.style.position = 'absolute';
          ray.style.width = '50vmin';
          ray.style.height = '1px';
          ray.style.backgroundColor = 'rgba(0, 229, 255, 0.1)';
          ray.style.top = 'calc(30% + 15vmin)';
          ray.style.left = 'calc(30% + 15vmin)';
          ray.style.transformOrigin = 'left center';
          ray.style.transform = `rotate(${i * 45}deg)`;
          container.appendChild(ray);
        }
      }
    }

    // ===== QUOTE MODULE =====
    function displayRandomQuote() {
      // Select random quote
      const randomIndex = Math.floor(Math.random() * CONFIG.quotes.length);
      const randomQuote = CONFIG.quotes[randomIndex];
      
      // Update DOM
      document.getElementById('quote-text').textContent = `${randomQuote.quote}`;
      document.getElementById('quote-author').textContent = `— ${randomQuote.author}`;
    }

    // ===== PHOTO MODULE - COMPLETELY REDESIGNED =====
    function initPhotoModule() {
      const photoShowcase = document.getElementById('photo-showcase');
      photoShowcase.innerHTML = '';
      state.photoFrames = [];
      state.currentPhotoIndex = 0;
      
      // Create frames for each photo
      CONFIG.photos.forEach((photo, index) => {
        const frame = document.createElement('div');
        frame.className = 'photo-frame';
        if (index === 0) {
          frame.classList.add('active');
        } else if (index === 1) {
          frame.classList.add('next');
        } else if (index === CONFIG.photos.length - 1) {
          frame.classList.add('prev');
        }
        
        const imageContainer = document.createElement('div');
        imageContainer.className = 'photo-image-container';
        
        const img = document.createElement('img');
        img.className = 'photo-image';
        img.src = photo.url;
        img.alt = photo.title;
        
        const info = document.createElement('div');
        info.className = 'photo-info';
        
        const title = document.createElement('div');
        title.className = 'photo-title';
        title.textContent = photo.title;
        
        const description = document.createElement('div');
        description.className = 'photo-description';
        description.textContent = photo.description;
        
        info.appendChild(title);
        info.appendChild(description);
        
        imageContainer.appendChild(img);
        imageContainer.appendChild(info);
        frame.appendChild(imageContainer);
        
        photoShowcase.appendChild(frame);
        state.photoFrames.push(frame);
      });
      
      // Update counter
      updatePhotoCounter(0);
      
      // Start progress bar
      startPhotoProgress();
    }

    function updatePhotoCounter(index) {
      const counter = document.getElementById('photo-counter');
      const current = (index + 1).toString().padStart(2, '0');
      const total = CONFIG.photos.length.toString().padStart(2, '0');
      counter.textContent = `${current} / ${total}`;
    }

    function startPhotoProgress() {
      // Reset progress bar
      const progressBar = document.getElementById('photo-progress-bar');
      progressBar.style.width = '0%';
      
      // Animate progress bar
      const duration = 10000; // 10 seconds per photo
      const startTime = Date.now();
      
      function updateProgress() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / duration * 100, 100);
        progressBar.style.width = `${progress}%`;
        
        if (progress < 100) {
          requestAnimationFrame(updateProgress);
        }
      }
      
      updateProgress();
    }

    function rotatePhotos() {
      if (state.photoFrames.length <= 1) return;
      
      // Get current, next and prev indices
      const currentIndex = state.currentPhotoIndex;
      const nextIndex = (currentIndex + 1) % state.photoFrames.length;
      const prevIndex = (currentIndex - 1 + state.photoFrames.length) % state.photoFrames.length;
      
      // Update classes
      state.photoFrames.forEach((frame, index) => {
        frame.classList.remove('active', 'next', 'prev');
        
        if (index === nextIndex) {
          frame.classList.add('active');
        } else if (index === (nextIndex + 1) % state.photoFrames.length) {
          frame.classList.add('next');
        } else if (index === (nextIndex - 1 + state.photoFrames.length) % state.photoFrames.length) {
          frame.classList.add('prev');
        }
      });
      
      // Update current index
      state.currentPhotoIndex = nextIndex;
      
      // Update counter
      updatePhotoCounter(nextIndex);
      
      // Restart progress bar
      startPhotoProgress();
    }

    // ===== MUSIC MODULE =====
// Add to state object (line 50 approximately)
playedTracks: [],

function initMusicPlayer() {
  // Create visualizer bars
  const visualizer = document.getElementById('music-visualizer');
  visualizer.innerHTML = '';
  state.visualizerBars = [];
  
  const barCount = 32;
  for (let i = 0; i < barCount; i++) {
    const bar = document.createElement('div');
    bar.className = 'visualizer-bar';
    visualizer.appendChild(bar);
    state.visualizerBars.push(bar);
  }
  
  // Initialize played tracks array
  state.playedTracks = [];
  
  // Start with random track
  selectNextTrack();
  updateMusicDisplay();
  playCurrentTrack();
  
  // Set up audio context for visualization
  try {
    state.audioContext = new (window.AudioContext || window.webkitAudioContext)();
    state.audioAnalyser = state.audioContext.createAnalyser();
    state.audioAnalyser.fftSize = 128;
    state.audioData = new Uint8Array(state.audioAnalyser.frequencyBinCount);
    
    const audioElement = document.getElementById('background-music');
    state.audioSource = state.audioContext.createMediaElementSource(audioElement);
    state.audioSource.connect(state.audioAnalyser);
    state.audioAnalyser.connect(state.audioContext.destination);
  } catch (e) {
    console.log('Web Audio API not supported or blocked by autoplay policy');
  }
}

function selectNextTrack() {
  // If all tracks have been played, reset the list
  if (state.playedTracks.length >= CONFIG.playlist.length) {
    state.playedTracks = [];
  }
  
  // Find unplayed tracks
  const unplayedTracks = [];
  for (let i = 0; i < CONFIG.playlist.length; i++) {
    if (!state.playedTracks.includes(i)) {
      unplayedTracks.push(i);
    }
  }
  
  // Select random from unplayed tracks
  if (unplayedTracks.length > 0) {
    const randomIndex = Math.floor(Math.random() * unplayedTracks.length);
    state.currentTrackIndex = unplayedTracks[randomIndex];
    state.playedTracks.push(state.currentTrackIndex);
  } else {
    // Fallback (shouldn't happen)
    state.currentTrackIndex = 0;
    state.playedTracks = [0];
  }
}

function updateMusicDisplay() {
  const track = CONFIG.playlist[state.currentTrackIndex];
  
  const titleElement = document.getElementById('song-title');
  titleElement.textContent = track.title;
  titleElement.setAttribute('data-text', track.title);
  
  document.getElementById('artist-name').textContent = track.artist;
  document.getElementById('album-name').textContent = track.album;
  document.getElementById('album-cover-img').src = track.cover;
}

function playCurrentTrack() {
  const track = CONFIG.playlist[state.currentTrackIndex];
  const audioElement = document.getElementById('background-music');
  
  audioElement.src = track.file;
  audioElement.volume = 0.5;
  
  audioElement.play().catch(err => {
    console.log("Auto-play blocked: " + err.message);
  });
  
  audioElement.onended = function() {
    selectNextTrack();
    updateMusicDisplay();
    playCurrentTrack();
  };
}
function updateMusicVisualizer() {
  if (!state.audioAnalyser || !state.audioData || !state.visualizerBars.length) {
    // Fallback animation when no audio analysis
    state.visualizerBars.forEach((bar, index) => {
      const height = 2 + Math.sin(Date.now() * 0.01 + index * 0.5) * 3;
      bar.style.height = `${height}vmin`;
      bar.style.backgroundColor = `hsl(${180 + Math.sin(Date.now() * 0.005 + index) * 30}, 100%, 50%)`;
    });
    return;
  }
  
  // Get frequency data
  state.audioAnalyser.getByteFrequencyData(state.audioData);
  
  // Calculate average for beat detection
  let sum = 0;
  for (let i = 0; i < state.audioData.length; i++) {
    sum += state.audioData[i];
  }
  const average = sum / state.audioData.length;
  
  // Beat detection threshold
  const beatThreshold = 128;
  const isBeat = average > beatThreshold;
  
  // Update album art based on beats
  const albumArt = document.querySelector('.album-art');
  if (isBeat) {
    albumArt.style.transform = 'translateZ(50px) scale(1.05)';
    albumArt.style.boxShadow = '0 0 80px rgba(0, 229, 255, 0.6)';
  } else {
    albumArt.style.transform = 'translateZ(50px) scale(1)';
    albumArt.style.boxShadow = '0 0 50px rgba(0, 229, 255, 0.2)';
  }
  
  // Update visualizer bars with beat emphasis
  const barCount = state.visualizerBars.length;
  for (let i = 0; i < barCount; i++) {
    const index = Math.floor(i * state.audioData.length / barCount);
    const value = state.audioData[index];
    let height = (value / 255) * 8;
    
    // Emphasize on beats
    if (isBeat) {
      height *= 1.5;
    }
    
    state.visualizerBars[i].style.height = `${Math.max(height, 0.5)}vmin`;
    
    // Dynamic color based on frequency and beats
    let hue = 180 + (value / 255) * 60;
    if (isBeat) {
      hue = 300 + Math.sin(Date.now() * 0.01) * 60; // Pink-purple range on beats
    }
    
    state.visualizerBars[i].style.backgroundColor = `hsl(${hue}, 100%, ${50 + (value / 255) * 30}%)`;
    state.visualizerBars[i].style.boxShadow = isBeat ? `0 0 10px hsl(${hue}, 100%, 50%)` : 'none';
  }
}

    // ===== DATA VISUALIZATION MODULE - COMPLETELY REDESIGNED =====
function initDataVisualization() {
  const container = document.getElementById('nexus-digital');
  container.innerHTML = '';
  container.className = 'quantum-canvas';
  
  // Add title
  const title = document.createElement('div');
  title.className = 'quantum-title';
  title.textContent = 'QUANTUM CANVAS';
  container.appendChild(title);
  
  // Create quantum field
  const field = document.createElement('div');
  field.className = 'quantum-field';
  container.appendChild(field);
  
  // Create floating particles
  for (let i = 0; i < 50; i++) {
    const particle = document.createElement('div');
    particle.className = 'quantum-particle';
    particle.style.left = `${Math.random() * 100}%`;
    particle.style.top = `${Math.random() * 100}%`;
    particle.style.animationDelay = `${Math.random() * 10}s`;
    particle.style.animation = `particle-float ${10 + Math.random() * 10}s infinite linear ${Math.random() * 5}s`;
    container.appendChild(particle);
  }
  
  // Create energy waves
  for (let i = 0; i < 12; i++) {
    const wave = document.createElement('div');
    wave.className = 'quantum-wave';
    wave.style.transform = `translate(-50%, -50%) rotate(${i * 30}deg)`;
    wave.style.animationDelay = `${i * 0.5}s`;
    wave.style.animation = `wave-flow ${8 + Math.random() * 4}s infinite ease-in-out ${i * 0.3}s`;
    container.appendChild(wave);
  }
  
  // Create spiral elements
  for (let i = 0; i < 8; i++) {
    const spiral = document.createElement('div');
    spiral.className = 'quantum-spiral';
    spiral.style.transform = `translate(-50%, 0) rotate(${i * 45}deg)`;
    spiral.style.animationDelay = `${i * 0.8}s`;
    spiral.style.animation = `spin ${20 + i * 5}s linear infinite`;
    container.appendChild(spiral);
  }
}

function animateDataVisualization() {
  // The quantum canvas is self-animating through CSS
  // This function can be used for additional dynamic effects
  const particles = document.querySelectorAll('.quantum-particle');
  
  // Randomly regenerate some particles
  const particlesToUpdate = Math.floor(Math.random() * 5) + 1;
  for (let i = 0; i < particlesToUpdate; i++) {
    const randomParticle = particles[Math.floor(Math.random() * particles.length)];
    if (randomParticle) {
      randomParticle.style.left = `${Math.random() * 100}%`;
      randomParticle.style.top = `${Math.random() * 100}%`;
    }
  }
}

    // ===== MODULE MANAGEMENT =====
function showModule(index) {
  // Hide all modules
  document.querySelectorAll('.module').forEach(module => {
    module.classList.remove('active');
  });

  // Show selected module
  const moduleId = CONFIG.modules[index];
  document.getElementById(moduleId).classList.add('active');
  state.currentModule = index;

  // Special handling for certain modules
  if (moduleId === 'photo-module') {
    rotatePhotos();
  } else if (moduleId === 'data-module') {
    animateDataVisualization();
  } else if (moduleId === 'weather-module') {
    fetchWeatherData(); // 🔄 Actualizar clima en cada aparición
  }
}


    function rotateModules() {
      const nextModule = (state.currentModule + 1) % CONFIG.modules.length;
      showModule(nextModule);
    }

    // ===== ANIMATION LOOP =====
    function animate() {
      updateBackground();
      updateParticles();
      updateMusicVisualizer();
      requestAnimationFrame(animate);
    }

    // ===== INITIALIZATION =====
    async function init() {
      // Initialize components
      initTimeModule();
      initPhotoModule();
      initMusicPlayer();
      initDataVisualization();
      
      // Start animation loop
      animate();
      
      // Set up timers
      setInterval(updateTime, 1000);
      updateTime();
      
      // Display initial quote
      displayRandomQuote();
      
      // Rotate quotes every 2 minutes
      setInterval(displayRandomQuote, 120000);
      
      // Fetch weather data
      await fetchWeatherData();
      
      // Update weather every 10 minutes
      setInterval(fetchWeatherData, 600000);
      
      // Show first module
      showModule(0);
      
      // Rotate modules
      setInterval(rotateModules, CONFIG.moduleDuration);
      
      // Rotate photos every 10 seconds
      setInterval(rotatePhotos, 10000);
      
      // Animate data visualization every 3 seconds when active
      setInterval(() => {
        if (CONFIG.modules[state.currentModule] === 'data-module') {
          animateDataVisualization();
        }
      }, 3000);
      
      // Add click event to start audio
      document.addEventListener('click', () => {
        const audioElement = document.getElementById('background-music');
        if (audioElement.paused) {
          audioElement.play().catch(error => {
            console.log("Error starting audio after click: " + error.message);
          });
        }
        
        // Try to enter fullscreen
        try {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
              console.log(`Error attempting to enable fullscreen: ${err.message}`);
            });
          }
        } catch (error) {
          console.log("Error toggling fullscreen: " + error.message);
        }
      });
      
      // Hide loading screen
      setTimeout(() => {
        document.getElementById('loading').classList.add('hidden');
      }, 2000);
    }

    // Start everything
    window.addEventListener('load', init);
  </script>
</body>
</html>
